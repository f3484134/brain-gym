<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#1a1a2e">
<link rel="manifest" href="manifest.json">
<title>è…¦åŠ›é«”æ“é¤¨</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
  color: #fff;
  min-height: 100vh;
  min-height: 100dvh;
  padding: 16px;
  padding-top: max(16px, env(safe-area-inset-top));
  overflow-x: hidden;
}
.header {
  text-align: center;
  padding: 24px 0 16px;
}
.header h1 {
  font-size: 1.8rem;
  margin-bottom: 6px;
}
.header .subtitle {
  font-size: 0.95rem;
  opacity: 0.7;
}
.streak-bar {
  background: rgba(255,255,255,0.1);
  border-radius: 16px;
  padding: 16px 20px;
  margin: 16px 0;
  text-align: center;
}
.streak-bar .streak-num {
  font-size: 2.5rem;
  font-weight: bold;
  color: #f9a825;
}
.streak-bar .streak-label {
  font-size: 0.9rem;
  opacity: 0.8;
}
.streak-dots {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin-top: 10px;
}
.streak-dot {
  width: 36px; height: 36px;
  border-radius: 50%;
  background: rgba(255,255,255,0.15);
  display: flex; align-items: center; justify-content: center;
  font-size: 0.75rem;
}
.streak-dot.done {
  background: #f9a825;
  color: #1a1a2e;
  font-weight: bold;
}
.streak-dot.today {
  border: 2px solid #f9a825;
  background: rgba(249,168,37,0.2);
}
.games-grid {
  display: grid;
  gap: 14px;
  margin-top: 20px;
}
.game-card {
  background: rgba(255,255,255,0.08);
  border-radius: 18px;
  padding: 20px;
  text-decoration: none;
  color: #fff;
  display: flex;
  align-items: center;
  gap: 14px;
  transition: transform 0.15s, background 0.15s;
  -webkit-tap-highlight-color: transparent;
}
.game-card:active {
  transform: scale(0.97);
  background: rgba(255,255,255,0.15);
}
.game-icon {
  font-size: 2.2rem;
  width: 54px; height: 54px;
  display: flex; align-items: center; justify-content: center;
  background: rgba(255,255,255,0.1);
  border-radius: 14px;
  flex-shrink: 0;
}
.game-info { flex: 1; min-width: 0; }
.game-info h3 { font-size: 1.1rem; margin-bottom: 3px; }
.game-info p { font-size: 0.8rem; opacity: 0.7; }
.game-card.locked { opacity: 0.4; pointer-events: none; }
.game-card .badge {
  background: #4caf50;
  color: #fff;
  font-size: 0.7rem;
  padding: 4px 10px;
  border-radius: 20px;
  font-weight: bold;
  flex-shrink: 0;
  white-space: nowrap;
}
.game-card .badge.todo { background: #f9a825; color: #1a1a2e; }
.game-card .badge.coming { background: rgba(255,255,255,0.2); }
.daily-complete {
  text-align: center;
  margin-top: 24px;
  padding: 24px 16px;
  background: rgba(76,175,80,0.15);
  border-radius: 18px;
  display: none;
}
.daily-complete h3 { font-size: 1.2rem; margin-bottom: 8px; }
.daily-complete p { font-size: 0.9rem; opacity: 0.8; margin-bottom: 4px; }
.daily-complete a {
  display: inline-block;
  margin-top: 12px;
  padding: 14px 24px;
  background: #e53935;
  color: #fff;
  text-decoration: none;
  border-radius: 14px;
  font-size: 1.05rem;
  font-weight: bold;
}
.seven-day-celebration {
  text-align: center;
  padding: 30px 16px;
  background: linear-gradient(135deg, rgba(249,168,37,0.2), rgba(233,30,99,0.15));
  border-radius: 18px;
  margin-top: 20px;
  display: none;
}
.seven-day-celebration h2 { font-size: 1.5rem; margin-bottom: 8px; }
.seven-day-celebration .fireworks { font-size: 3rem; margin-bottom: 12px; }
</style>
</head>
<body>

<div class="header">
  <h1>ğŸ§  è…¦åŠ›é«”æ“é¤¨</h1>
  <p class="subtitle">æ¯å¤©å‹•å‹•è…¦ï¼Œè¶Šç©è¶Šå¹´è¼•</p>
</div>

<div class="streak-bar">
  <div class="streak-num" id="streakNum">0</div>
  <div class="streak-label">ğŸ”¥ é€£çºŒæ‰“å¡å¤©æ•¸</div>
  <div class="streak-dots" id="streakDots"></div>
</div>

<div class="seven-day-celebration" id="sevenDayCelebration">
  <div class="fireworks">ğŸ†ğŸ†ğŸ†</div>
  <h2>é€£çºŒä¸ƒå¤©æ‰“å¡ï¼</h2>
  <p>å¤ªäº†ä¸èµ·äº†ï¼å …æŒå°±æ˜¯å‹åˆ© ğŸ’ª</p>
</div>

<div class="games-grid" id="gamesGrid">
  <a class="game-card" href="games/memory-cards/" id="game-memory">
    <div class="game-icon">ğŸƒ</div>
    <div class="game-info">
      <h3>è¨˜æ†¶ç¿»ç‰Œ</h3>
      <p>ç¿»é–‹é…å°ï¼Œè¨“ç·´çŸ­æœŸè¨˜æ†¶</p>
    </div>
    <span class="badge todo">ä»Šæ—¥ä»»å‹™</span>
  </a>
  <a class="game-card" href="games/number-sort/" id="game-numsort">
    <div class="game-icon">ğŸ”¢</div>
    <div class="game-info">
      <h3>æ•¸å­—æ’åº</h3>
      <p>å¿«é€Ÿæ’åˆ—ï¼Œé›éŠåæ‡‰åŠ›</p>
    </div>
    <span class="badge todo">å¯ä»¥ç©</span>
  </a>
  <div class="game-card locked">
    <div class="game-icon">ğŸ¨</div>
    <div class="game-info">
      <h3>é¡è‰²æŒ‘æˆ°</h3>
      <p>çœ‹å­—è¾¨è‰²ï¼Œè€ƒé©—å°ˆæ³¨åŠ›</p>
    </div>
    <span class="badge coming">å³å°‡æ¨å‡º</span>
  </div>
  <div class="game-card locked">
    <div class="game-icon">â•</div>
    <div class="game-info">
      <h3>å¿ƒç®—ç·´ç¿’</h3>
      <p>åŠ æ¸›ä¹˜é™¤ï¼Œä¿æŒé ­è…¦éˆæ´»</p>
    </div>
    <span class="badge coming">å³å°‡æ¨å‡º</span>
  </div>
</div>

<div class="daily-complete" id="dailyComplete">
  <h3>ğŸ‰ ä»Šå¤©çš„è¨“ç·´å®Œæˆäº†ï¼</h3>
  <p>è¾›è‹¦äº†ï¼çœ‹å€‹æœ‰è¶£çš„å½±ç‰‡ä¼‘æ¯ä¸€ä¸‹å§</p>
  <a id="rewardLink" href="#" target="_blank">â–¶ï¸ è§€çœ‹ä»Šæ—¥çå‹µå½±ç‰‡</a>
</div>

<script>
const STORAGE_KEY = 'brain-gym-data';

// All verified working YouTube videos â€” Chinese language
const REWARD_VIDEOS = [
  // ğŸ›ï¸ æ­·å²æ–‡åŒ–
  { title: 'ğŸ›ï¸ æ•…å®®åœ‹å¯¶å¤§é·å¾™', url: 'https://www.youtube.com/watch?v=v9LbimMUSZY' },
  { title: 'ğŸ›ï¸ æ•…å®®è¶…é™æ™‚å±•ãƒ»è¯å¤è‡³å¯¶', url: 'https://www.youtube.com/watch?v=BhQ7qY1eLJA' },
  { title: 'ğŸ”§ æˆ‘åœ¨æ•…å®®ä¿®æ–‡ç‰©ï¼ˆç¬¬ä¸€é›†ï¼‰', url: 'https://www.youtube.com/watch?v=m81MOraQtz0' },
  { title: 'ğŸ¯ æ•…å®®ç´«ç¦åŸç´€å¯¦', url: 'https://www.youtube.com/watch?v=JE1CyLnXGjM' },
  { title: 'ğŸ§± é•·åŸÂ·ä¸­åœ‹çš„æ•…äº‹', url: 'https://www.youtube.com/watch?v=3Z2Lc8Hn_lM' },
  // ğŸœ ç¾é£Ÿ
  { title: 'ğŸœ èˆŒå°–ä¸Šçš„æ–°å¹´', url: 'https://www.youtube.com/watch?v=izaL8-9InqY' },
  { title: 'ğŸœ èˆŒå°–ä¸Šçš„ä¸­åœ‹ãƒ»ä¸€æ—¥ä¸‰é¤', url: 'https://www.youtube.com/watch?v=fZsSANHG3Qc' },
  { title: 'ğŸœ èˆŒå°–ä¸Šçš„ä¸­åœ‹ãƒ»æ™‚é–“çš„å‘³é“', url: 'https://www.youtube.com/watch?v=jjzF6-AfiI0' },
  { title: 'ğŸœ æ—©é¤ä¸­åœ‹ãƒ»æ°´ç²‰å’Œè±¬è…³ç²‰', url: 'https://www.youtube.com/watch?v=fzfq2mqL7lA' },
  { title: 'ğŸœ è¡—é ­ç¾é£Ÿå°åƒå¤§åˆé›†', url: 'https://www.youtube.com/watch?v=M-JND9TA1Hw' },
  // ğŸ¾ è‡ªç„¶ç§‘å­¸
  { title: 'ğŸ¾ è‡ªç„¶çš„åŠ›é‡ãƒ»é‡ç”Ÿå‹•ç‰©', url: 'https://www.youtube.com/watch?v=Ar-YZoPNTS4' },
  { title: 'ğŸ¦ ä¸­åœ‹ç€•å±é‡ç”Ÿå‹•ç‰©å…¨è¨˜éŒ„', url: 'https://www.youtube.com/watch?v=X1YJg3eg0Jg' },
  { title: 'ğŸŒŒ å®‡å®™æ€ªç¸ãƒ»é»‘æ´', url: 'https://www.youtube.com/watch?v=5N1HE3Hcshs' },
  { title: 'ğŸš€ å®‡å®™æ™‚ç©ºä¹‹æ—…ç²¾é¸', url: 'https://www.youtube.com/watch?v=tfNBUX8J8b4' },
  // ğŸ˜‚ æç¬‘ç¶œè—
  { title: 'ğŸ˜‚ ç¶œè—å¤§ç†±é–€ãƒ»è¶…å¥½ç¬‘ç¸½åŒ¯', url: 'https://www.youtube.com/watch?v=XRlR_Ibjslc' },
  { title: 'ğŸ˜‚ ç¶œè—å¤§ç†±é–€ãƒ»æ†²å“¥å¤ªæ£’å•¦', url: 'https://www.youtube.com/watch?v=gaWTzt4z2vs' },
  { title: 'ğŸ˜‚ å¤§ç†±é–€ãƒ»å”å¾è–è¶…å¥½ç¬‘ç‹—è¡€è©®é‡‹', url: 'https://www.youtube.com/watch?v=gRLMfHSOiIU' },
  // ğŸ’ª å¥åº·é¤Šç”Ÿ
  { title: 'ğŸ’ª å¥èº«æ°£åŠŸå…­å­—è¨£ï¼ˆ6åˆ†é˜è·Ÿç·´ï¼‰', url: 'https://www.youtube.com/watch?v=zSWG0PpWFwk' },
  { title: 'ğŸ”ï¸ èµ°è¿‘å¤§æ¶¼å±±', url: 'https://www.youtube.com/watch?v=zF9LJLLo4OA' },
];

function getData() {
  try {
    return JSON.parse(localStorage.getItem(STORAGE_KEY)) || { days: {}, streak: 0 };
  } catch { return { days: {}, streak: 0 }; }
}
function saveData(d) { localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); }

function todayKey() {
  const d = new Date();
  return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
}

function calcStreak(data) {
  let streak = 0;
  const d = new Date();
  const key = todayKey();
  if (!data.days[key]) d.setDate(d.getDate() - 1);
  for (let i = 0; i < 365; i++) {
    const k = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
    if (data.days[k]) { streak++; d.setDate(d.getDate() - 1); }
    else break;
  }
  return streak;
}

function render() {
  const data = getData();
  const streak = calcStreak(data);
  const today = todayKey();
  const todayDone = !!data.days[today];

  document.getElementById('streakNum').textContent = streak;

  // 7-day celebration
  if (streak >= 7 && streak % 7 === 0) {
    document.getElementById('sevenDayCelebration').style.display = 'block';
  }

  // Render 7-day dots
  const dotsEl = document.getElementById('streakDots');
  dotsEl.innerHTML = '';
  const labels = ['ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','æ—¥'];
  const now = new Date();
  const dow = now.getDay() || 7;
  for (let i = 1; i <= 7; i++) {
    const diff = i - dow;
    const dd = new Date(now);
    dd.setDate(dd.getDate() + diff);
    const k = `${dd.getFullYear()}-${String(dd.getMonth()+1).padStart(2,'0')}-${String(dd.getDate()).padStart(2,'0')}`;
    const dot = document.createElement('div');
    dot.className = 'streak-dot';
    if (data.days[k]) dot.classList.add('done');
    if (k === today) dot.classList.add('today');
    dot.textContent = labels[i-1];
    dotsEl.appendChild(dot);
  }

  // Game card badge
  const badge = document.querySelector('#game-memory .badge');
  if (todayDone) {
    badge.textContent = 'âœ… å·²å®Œæˆ';
    badge.className = 'badge';
    badge.style.background = '#4caf50';
  }

  // Show reward
  if (todayDone) {
    const complete = document.getElementById('dailyComplete');
    complete.style.display = 'block';
    // Use day-based seed so same video all day
    const dayNum = Math.floor(Date.now() / 86400000);
    const video = REWARD_VIDEOS[dayNum % REWARD_VIDEOS.length];
    const link = document.getElementById('rewardLink');
    link.href = video.url;
    link.textContent = `â–¶ï¸ ${video.title}`;
  }
}

// Listen for game completion messages
window.addEventListener('message', (e) => {
  if (e.data && e.data.type === 'game-complete') {
    const data = getData();
    data.days[todayKey()] = {
      game: e.data.game,
      score: e.data.score,
      time: e.data.time,
      timestamp: Date.now()
    };
    saveData(data);
    render();
  }
});

// Check URL params (fallback for game completion)
const params = new URLSearchParams(location.search);
if (params.get('completed')) {
  const data = getData();
  if (!data.days[todayKey()]) {
    data.days[todayKey()] = {
      game: params.get('game') || 'memory',
      score: parseInt(params.get('score')) || 0,
      time: parseInt(params.get('time')) || 0,
      timestamp: Date.now()
    };
    saveData(data);
  }
  history.replaceState({}, '', location.pathname);
}

render();
</script>
</body>
</html>
